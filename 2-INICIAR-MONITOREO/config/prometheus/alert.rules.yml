groups:
- name: AlertasGenerales
  rules:
  # === ALERTAS DE CPU ===
  - alert: AltaCargaCPU
    expr: (100 - (avg by (instance) (rate(node_cpu_seconds_total{mode="idle"}[2m])) * 100)) > 80
    for: 5m
    labels:
      severity: warning
      component: cpu
    annotations:
      summary: "üö® Alta carga de CPU detectada"
      description: "La instancia {{ $labels.instance }} ha superado el 80% de uso de CPU durante m√°s de 5 minutos. Valor actual: {{ $value | humanize }}%"

  - alert: CargaCriticaCPU
    expr: (100 - (avg by (instance) (rate(node_cpu_seconds_total{mode="idle"}[2m])) * 100)) > 95
    for: 2m
    labels:
      severity: critical
      component: cpu
    annotations:
      summary: "üî• CR√çTICO: CPU al l√≠mite"
      description: "La instancia {{ $labels.instance }} tiene un uso de CPU cr√≠tico: {{ $value | humanize }}%"

  # === ALERTAS DE MEMORIA ===
  - alert: AltaMemoria
    expr: (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100 > 85
    for: 5m
    labels:
      severity: warning
      component: memory
    annotations:
      summary: "üß† Alto uso de memoria RAM"
      description: "La instancia {{ $labels.instance }} est√° usando {{ $value | humanize }}% de RAM"

  - alert: MemoriaCritica
    expr: (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100 > 95
    for: 2m
    labels:
      severity: critical
      component: memory
    annotations:
      summary: "üî¥ CR√çTICO: Memoria RAM agotada"
      description: "La instancia {{ $labels.instance }} tiene memoria RAM cr√≠tica: {{ $value | humanize }}%"

  # === ALERTAS DE DISCO ===
  - alert: DiscoLleno
    expr: (1 - (node_filesystem_avail_bytes{mountpoint="/"} / node_filesystem_size_bytes{mountpoint="/"})) * 100 > 85
    for: 5m
    labels:
      severity: warning
      component: disk
    annotations:
      summary: "üíæ Espacio en disco bajo"
      description: "El disco en {{ $labels.instance }} est√° al {{ $value | humanize }}% de capacidad"

  - alert: DiscoCritico
    expr: (1 - (node_filesystem_avail_bytes{mountpoint="/"} / node_filesystem_size_bytes{mountpoint="/"})) * 100 > 95
    for: 2m
    labels:
      severity: critical
      component: disk
    annotations:
      summary: "üÜò CR√çTICO: Disco casi lleno"
      description: "El disco en {{ $labels.instance }} est√° al {{ $value | humanize }}% - ¬°Espacio cr√≠tico!"

  # === ALERTAS DE RED ===
  - alert: AltaRedSubida
    expr: rate(node_network_transmit_bytes_total{device!="lo"}[5m]) > 100000000  # 100MB/s
    for: 10m
    labels:
      severity: warning
      component: network
    annotations:
      summary: "üì§ Alto tr√°fico de subida"
      description: "Tr√°fico de subida elevado en {{ $labels.instance }}: {{ $value | humanize1024 }}B/s"

  - alert: AltaRedBajada
    expr: rate(node_network_receive_bytes_total{device!="lo"}[5m]) > 100000000  # 100MB/s
    for: 10m
    labels:
      severity: warning
      component: network
    annotations:
      summary: "üì• Alto tr√°fico de bajada"
      description: "Tr√°fico de bajada elevado en {{ $labels.instance }}: {{ $value | humanize1024 }}B/s"

  # === ALERTAS DE DISPONIBILIDAD ===
  - alert: InstanciaNoDisponible
    expr: up == 0
    for: 1m
    labels:
      severity: critical
      component: availability
    annotations:
      summary: "üîå Servidor no disponible"
      description: "El job '{{ $labels.job }}' en la instancia {{ $labels.instance }} no est√° respondiendo"

  - alert: ExporterCaido
    expr: up{job!="prometheus"} == 0
    for: 3m
    labels:
      severity: warning
      component: monitoring
    annotations:
      summary: "üìä Exporter de m√©tricas ca√≠do"
      description: "El exporter '{{ $labels.job }}' no est√° enviando m√©tricas desde hace 3 minutos"

  # === ALERTAS DE I/O DISCO ===
  - alert: AltaIODisco
    expr: rate(node_disk_read_bytes_total[5m]) + rate(node_disk_written_bytes_total[5m]) > 50000000  # 50MB/s
    for: 15m
    labels:
      severity: warning
      component: disk_io
    annotations:
      summary: "üíø Alto I/O de disco"
      description: "I/O de disco elevado en {{ $labels.instance }}: {{ $value | humanize1024 }}B/s"

# === GRUPO DE ALERTAS PERSONALIZABLES ===
- name: AlertasPersonalizadas
  rules:
  # Agrega aqu√≠ tus alertas personalizadas
  # Ejemplo:
  # - alert: MiAlertaCustom
  #   expr: mi_metrica > 100
  #   for: 5m
  #   labels:
  #     severity: info
  #   annotations:
  #     summary: "Mi alerta personalizada"
  #     description: "Descripci√≥n de mi alerta"